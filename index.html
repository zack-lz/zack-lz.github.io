<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Virtual Business Card Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(45deg, #a1c4fd, #c2e9fb);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      margin: 20px 0;
      color: #333;
      font-size: 2rem;
    }

    .container {
      max-width: 900px;
      width: 100%;
      padding: 20px;
      background-color: #fff;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      border-radius: 15px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    label {
      display: block;
      font-weight: bold;
      margin-bottom: 5px;
      color: #555;
    }

    input, textarea, select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
    }

    .card-preview {
      margin-top: 20px;
      position: relative;
      width: 100%;
      max-width: 400px;
      height: 250px;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 20px;
      color: #fff;
    }

    .card-preview h2, .card-preview p {
      margin: 5px 0;
    }

    .actions {
      margin-top: 20px;
    }

    .actions button {
      margin-right: 10px;
      padding: 10px 20px;
      background-color: #007BFF;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease-in-out;
    }

    .actions button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <h1>Advanced Virtual Business Card Generator</h1>
  <div class="container">
    <!-- Input Form -->
    <div class="form-group">
      <label for="name">Your Name:</label>
      <input type="text" id="name" placeholder="Enter your name" oninput="updateCard()">
    </div>
    <div class="form-group">
      <label for="job-title">Job Title:</label>
      <input type="text" id="job-title" placeholder="Enter your job title" oninput="updateCard()">
    </div>
    <div class="form-group">
      <label for="email">Email Address:</label>
      <input type="email" id="email" placeholder="Enter your email" oninput="updateCard()">
    </div>
    <div class="form-group">
      <label for="phone">Phone Number:</label>
      <input type="tel" id="phone" placeholder="Enter your phone number" oninput="updateCard()">
    </div>
    <div class="form-group">
      <label for="template">Choose Template:</label>
      <select id="template" onchange="updateTemplate()">
        <option value="1">Template 1 - Classic</option>
        <option value="2">Template 2 - Creative</option>
        <option value="3">Template 3 - Modern</option>
        <option value="4">Template 4 - Minimalist</option>
        <option value="5">Template 5 - Vibrant</option>
        <option value="6">Template 6 - Professional</option>
        <option value="7">Template 7 - Nature</option>
        <option value="8">Template 8 - Luxury</option>
        <option value="9">Template 9 - Artistic</option>
        <option value="10">Template 10 - Futuristic</option>
      </select>
    </div>

    <!-- Business Card Preview -->
    <div id="card" class="card-preview" style="background-image: url('https://via.placeholder.com/400x250');">
      <h2 id="card-name">Your Name</h2>
      <p id="card-title">Your Job Title</p>
      <p id="card-email">Your Email</p>
      <p id="card-phone">Your Phone</p>
    </div>

    <!-- Actions -->
    <div class="actions">
      <button onclick="downloadPDF()">Download as PDF</button>
      <button onclick="downloadImage()">Download as Image</button>
    </div>
  </div>

  <script>
    const backgrounds = [
      'https://bpic.588ku.com/back_pic/06/19/07/796343d64bb1d3f.jpg',
      'https://thumbs.dreamstime.com/b/%E5%88%9B%E9%80%A0%E6%80%A7%E7%9A%84%E6%8A%BD%E8%B1%A1%E6%89%8B%E7%94%BB%E8%83%8C%E6%99%AF%EF%BC%8C%E5%A2%99%E7%BA%B8%EF%BC%8C%E7%BA%B9%E7%90%86%EF%BC%8C-c-121717803.jpg',
      'https://bpic.588ku.com/back_origin_pic/23/07/01/4fde26b737c048841d7f1afedfc8abb7.png',
      'https://img.pikbest.com/background/20220119/minimalist-blue-business-card-design-set_6218607.jpg!bw700',
      'https://t4.ftcdn.net/jpg/03/97/65/77/360_F_397657763_DFZJP0pxGvkYp1OyYM2FvigWZvWerBcv.jpg',
      'https://www.shutterstock.com/image-vector/abstract-black-gold-lines-luxury-600nw-2019889451.jpg',
      'https://static.vecteezy.com/system/resources/previews/000/106/382/non_2x/vector-eco-friendly-business-card.jpg',
      'https://th.bing.com/th/id/R.c839805604675bf984b86795ffa66af5?rik=mWcNI0VXgYxSpg&riu=http%3a%2f%2fpic.616pic.com%2fbg_w1180%2f00%2f05%2f19%2fAkgYOMR424.jpg!%2ffw%2f1120&ehk=jPFjIaU21XZe5SzXWUEDXXegEorcuBJW8rGO8aAdA%2bU%3d&risl=&pid=ImgRaw&r=0',
      'https://thumbs.dreamstime.com/b/%E8%89%BA%E6%9C%AF%E6%80%A7%E7%9A%84%E8%83%8C%E6%99%AF-37148458.jpg',
      'https://static.vecteezy.com/system/resources/previews/027/498/471/non_2x/business-card-futuristic-background-for-technology-and-finance-concept-and-education-for-future-vector.jpg',
    ];

    function updateCard() {
      const name = document.getElementById('name').value || 'Your Name';
      const title = document.getElementById('job-title').value || 'Your Job Title';
      const email = document.getElementById('email').value || 'Your Email';
      const phone = document.getElementById('phone').value || 'Your Phone';

      document.getElementById('card-name').innerText = name;
      document.getElementById('card-title').innerText = title;
      document.getElementById('card-email').innerText = email;
      document.getElementById('card-phone').innerText = phone;
    }

    function updateTemplate() {
    const template = parseInt(document.getElementById('template').value);
    const card = document.getElementById('card');
  
    const imgURL = backgrounds[template - 1];
    const img = new Image();
    img.src = imgURL;

    img.onload = () => {
      card.style.backgroundImage = `url(${imgURL})`;
    };

    img.onerror = () => {
      // 如果图片加载失败，使用占位图片
      card.style.backgroundImage = "url('https://via.placeholder.com/400x250?text=Template+Image+Not+Found')";
      alert('Failed to load background image. Using placeholder instead.');
    };

    // 改变字体颜色为黑色的模板
    if ([1, 2, 3, 5, 7, 8, 9].includes(template)) {
      card.style.color = '#000';  // 黑色字体
    } else {
      card.style.color = '#fff';  // 白色字体
    }

    if ([7, 8, 9].includes(template)) {
      card.style.justifyContent = 'flex-start';
      card.style.alignItems = 'flex-start';
      card.style.textAlign = 'left';
      card.style.padding = '20px';
    } else {
      card.style.justifyContent = 'flex-end';
      card.style.alignItems = 'flex-start';
      card.style.textAlign = 'left';
      card.style.padding = '20px';
    }
  }
  



async function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();
  const card = document.getElementById('card');

  // 等待背景图片加载
  await new Promise((resolve) => setTimeout(resolve, 100)); // 短暂延迟确保样式已应用

  try {
    const canvas = await html2canvas(card, {
      scale: 2,
      useCORS: true, // 确保跨域资源被正确加载
      allowTaint: false, // 禁止 tainting 跨域资源
    });
    const imgData = canvas.toDataURL('image/png');
    const imgWidth = 190;
    const imgHeight = (canvas.height * imgWidth) / canvas.width;
    pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);
    pdf.save('business_card.pdf');
  } catch (error) {
    console.error('Error generating PDF:', error);
    alert('Failed to generate PDF. Please try again.');
  }
}

async function downloadImage() {
  const card = document.getElementById('card');

  // 等待背景图片加载
  await new Promise((resolve) => setTimeout(resolve, 100)); // 短暂延迟确保样式已应用

  try {
    const canvas = await html2canvas(card, {
      scale: 2,
      useCORS: true, // 确保跨域资源被正确加载
      allowTaint: false, // 禁止 tainting 跨域资源
    });
    const link = document.createElement('a');
    link.download = 'business_card.png';
    link.href = canvas.toDataURL('image/png');
    link.click();
  } catch (error) {
    console.error('Error generating Image:', error);
    alert('Failed to generate Image. Please try again.');
  }
}


  </script>
</body>
</html>
